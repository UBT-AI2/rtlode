# rtlode

[![DOI](https://zenodo.org/badge/372437289.svg)](https://zenodo.org/badge/latestdoi/372437289)

An open source tool that can automatically generate logic circuits from a user-friendly configuration file for efficiently solving systems of ODEs on FPGAs.

## Supported FPGAs
Currently, only the *[Intel Programmable Acceleration Card with Intel Arria 10 GX 1150 FPGA](https://www.intel.com/content/dam/www/programmable/us/en/pdfs/literature/hb/arria-10/a10_handbook.pdf)* is supported.
If you don't have the required hardware, you can still simulate the logic generated by rtlode (see [Simulation](#simulation)).

## Installation
If you want only to simulate the generated logic you can skip step 1, 2 and 3.

1. Install [OPAE](https://01.org/OPAE) by following the instructions [here](https://opae.github.io/latest/docs/install_guide/installation_guide.html).

2. Install the OPAE python bindings as described [here](https://opae.github.io/latest/docs/README.html#installation).

3. Install [Quartus Prime](https://www.intel.de/content/www/de/de/software/programmable/quartus-prime/overview.html) and make it availabe in the path.

4. Install additional dependencies required by rtlode:
    ```bash
    pip install -r requirements.txt
    ```

5. Optional for co-simulation: Install [iverilog](https://github.com/steveicarus/iverilog) and make it available in the path.

## Usage
1. Create or adjust configuration files ([format.md](config/format.md)) for the initial value problem, and the solver method to use.
    Example configuration files can be found in [config](config).

2. Create a solver unit with given configuration files:
    ```bash
    rtlode build heun.yaml predator-prey.yaml
    ```

3.  To test your solver you can execute the following command:
    ```bash
    rtlode run heun_predator-prey.slv --runtime_config='{x: 0, y: [0, 2], n: 60, h: 0.17}'
    ```
    Alternativly a simple benchmark can be performed:
    ```bash
    rtlode benchmark heun_predator-prey.slv --runtime_config='{x: 0, y: [0, 2], n: 60, h: 0.17}'
    ```

## Simulation

```python
from generator.generator import simulate
simulate('config/numeric/default_fixed.yaml', 'config/problems/predator-prey.yaml', 'config/methods/heun.yaml')
```

Co-simulation with [iverilog](https://github.com/steveicarus/iverilog) is also possible:
```python
from generator.generator import simulate
simulate('config/numeric/default_fixed.yaml', 'config/problems/predator-prey.yaml', 'config/methods/heun.yaml', cosimulate=True)
```

To create a verilog file for manual inspection you can call the convert logic directly. The generated files can be found in `generator/out/`.
```python
from generator.generator import convert, _load_config
convert(_load_config('config/numeric/default_fixed.yaml', 'config/problems/vdpol.yaml', 'config/methods/rk4.yaml'))
```

## License
rtlode is licensed under the [MIT](LICENSE) license.